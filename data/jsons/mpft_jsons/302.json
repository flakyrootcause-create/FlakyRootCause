{
  "id": 302,
  "repo": "matplotlib",
  "issue_url": "https://github.com/matplotlib/matplotlib/pull/28858",
  "pr_url": "https://github.com/matplotlib/matplotlib/pull/28858",
  "issue_description": "## PR summary\r\n\r\nFor labelcolor={linecolor,markeredgecolor,markerfacecolor}, text will match the specified attribute if consistent, but fall back to black if they differ within a single labeled artist.\r\n\r\nThese tests use 10 random colours out of the ['r', 'g', 'b'] set, so 3 (all red, all green, all blue) out of 3**10 will result in the text _not_ being black. This is rare (0.0051%), but does happen once in a while (e.g., https://github.com/matplotlib/matplotlib/actions/runs/10967975776/job/30458622005).\r\n\r\nInstead, just hard-code some different colours in the test.\r\n\r\n## PR checklist\r\n\r\n- [n/a] \"closes #0000\" is in the body of the PR description to [link the related issue](https://docs.github.com/en/issues/tracking-your-work-with-issues/linking-a-pull-request-to-an-issue)\r\n- [x] new and changed code is [tested](https://matplotlib.org/devdocs/devel/testing.html)\r\n- [n/a] *Plotting related* features are demonstrated in an [example](https://matplotlib.org/devdocs/devel/document.html#write-examples-and-tutorials)\r\n- [n/a] *New Features* and *API Changes* are noted with a [directive and release note](https://matplotlib.org/devdocs/devel/api_changes.html#announce-changes-deprecations-and-new-features)\r\n- [n/a] Documentation complies with [general](https://matplotlib.org/devdocs/devel/document.html#write-rest-pages) and [docstring](https://matplotlib.org/devdocs/devel/document.html#write-docstrings) guidelines",
  "files_changed": [
    {
      "filename": "lib/matplotlib/tests/test_legend.py",
      "status": "modified",
      "patch": "@@ -868,8 +868,8 @@ def test_legend_pathcollection_labelcolor_linecolor_iterable():\n     # test the labelcolor for labelcolor='linecolor' on PathCollection\n     # with iterable colors\n     fig, ax = plt.subplots()\n-    colors = np.random.default_rng().choice(['r', 'g', 'b'], 10)\n-    ax.scatter(np.arange(10), np.arange(10)*1, label='#1', c=colors)\n+    colors = np.array(['r', 'g', 'b', 'c', 'm'] * 2)\n+    ax.scatter(np.arange(10), np.arange(10), label='#1', c=colors)\n \n     leg = ax.legend(labelcolor='linecolor')\n     text, = leg.get_texts()\n@@ -915,8 +915,8 @@ def test_legend_pathcollection_labelcolor_markeredgecolor_iterable():\n     # test the labelcolor for labelcolor='markeredgecolor' on PathCollection\n     # with iterable colors\n     fig, ax = plt.subplots()\n-    colors = np.random.default_rng().choice(['r', 'g', 'b'], 10)\n-    ax.scatter(np.arange(10), np.arange(10)*1, label='#1', edgecolor=colors)\n+    colors = np.array(['r', 'g', 'b', 'c', 'm'] * 2)\n+    ax.scatter(np.arange(10), np.arange(10), label='#1', edgecolor=colors)\n \n     leg = ax.legend(labelcolor='markeredgecolor')\n     for text, color in zip(leg.get_texts(), ['k']):\n@@ -970,8 +970,8 @@ def test_legend_pathcollection_labelcolor_markerfacecolor_iterable():\n     # test the labelcolor for labelcolor='markerfacecolor' on PathCollection\n     # with iterable colors\n     fig, ax = plt.subplots()\n-    colors = np.random.default_rng().choice(['r', 'g', 'b'], 10)\n-    ax.scatter(np.arange(10), np.arange(10)*1, label='#1', facecolor=colors)\n+    colors = np.array(['r', 'g', 'b', 'c', 'm'] * 2)\n+    ax.scatter(np.arange(10), np.arange(10), label='#1', facecolor=colors)\n \n     leg = ax.legend(labelcolor='markerfacecolor')\n     for text, color in zip(leg.get_texts(), ['k']):"
    }
  ],
  "fix_category": "Other",
  "root_cause_category": "Concurrency",
  "root_cause_subcategory": NaN
}